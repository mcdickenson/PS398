upperEst<- pHats[995,1:6]
lowerEst<- pHats[5,1:6]
plot(c(.5,.9),c(0,10), xlim=c(.5,.9), col=0, xlab="Predicted Probability of Deaths >0", ylab="Density")
for(i in c(1:6)) {
lines(density(simProbs[,i]), col=i)
lines(c(lowerEst[i], lowerEst[i]), c(0,2), col=i, lwd=2)
lines(c(upperEst[i], uppeEstr[i]), c(0,2), col=i, lwd=2)
}
plot(c(.5,.9),c(0,10), xlim=c(.5,.9), col=0, xlab="Predicted Probability of Deaths >0", ylab="Density")
for(i in c(1:6)) {
lines(density(simProbs[,i]), col=i)
lines(c(lowerEst[i], lowerEst[i]), c(0,2), col=i, lwd=2)
lines(c(upperEst[i], uppeEst[i]), c(0,2), col=i, lwd=2)
}
plot(c(.5,.9),c(0,10), xlim=c(.5,.9), col=0, xlab="Predicted Probability of Deaths >0", ylab="Density")
for(i in c(1:6)) {
lines(density(simProbs[,i]), col=i)
lines(c(lowerEst[i], lowerEst[i]), c(0,2), col=i, lwd=2)
lines(c(upperEst[i], upperEst[i]), c(0,2), col=i, lwd=2)
}
plot(c(.5,1),c(0,10), xlim=c(.5,.9), col=0, xlab="Predicted Probability of Deaths >0", ylab="Density")
for(i in c(1:6)) {
lines(density(simProbs[,i]), col=i)
lines(c(lowerEst[i], lowerEst[i]), c(0,2), col=i, lwd=2)
lines(c(upperEst[i], upperEst[i]), c(0,2), col=i, lwd=2)
}
plot(c(.5,1),c(0,10), xlim=c(.5,1), col=0, xlab="Predicted Probability of Deaths >0", ylab="Density")
for(i in c(1:6)) {
lines(density(simProbs[,i]), col=i)
lines(c(lowerEst[i], lowerEst[i]), c(0,2), col=i, lwd=2)
lines(c(upperEst[i], upperEst[i]), c(0,2), col=i, lwd=2)
}
simProbs[,4]
simProbs
plot(c(.5,1),c(0,10), xlim=c(0,1), col=0, xlab="Predicted Probability of Deaths >0", ylab="Density")
for(i in c(1:6)) {
lines(density(simProbs[,i]), col=i)
lines(c(lowerEst[i], lowerEst[i]), c(0,2), col=i, lwd=2)
lines(c(upperEst[i], upperEst[i]), c(0,2), col=i, lwd=2)
}
legend("topleft", c("min", "1st quartile", "median", "mean", "3rd quartile", "max"))
legend("topleft", c("min", "1st quartile", "median", "mean", "3rd quartile", "max"),pch=16, col=c(1:6))
plot(c(.5,1),c(0,10), xlim=c(0,1), col=0, xlab="Predicted Probability of Deaths >0", ylab="Density")
for(i in c(1:6)) {
lines(density(simProbs[,i]), col=i)
lines(c(lowerEst[i], lowerEst[i]), c(0,2), col=i, lwd=2)
lines(c(upperEst[i], upperEst[i]), c(0,2), col=i, lwd=2)
}
legend("topleft", c("Min", "1st Quartile", "Median", "Mean", "3rd Quartile", "Max"),pch=16, col=c(1:6))
lowerEst
UpperEst
upperEst
upperEst<- simProbs[995,1:6]
lowerEst<- simProbs[5,1:6]
plot(c(.5,1),c(0,10), xlim=c(0,1), col=0, xlab="Predicted Probability of Deaths >0", ylab="Density")
for(i in c(1:6)) {
lines(density(simProbs[,i]), col=i)
lines(c(lowerEst[i], lowerEst[i]), c(0,2), col=i, lwd=2)
lines(c(upperEst[i], upperEst[i]), c(0,2), col=i, lwd=2)
}
legend("topleft", c("Min", "1st Quartile", "Median", "Mean", "3rd Quartile", "Max"),pch=16, col=c(1:6))
?glm
print mymodel1
mymodel1
plot(density(as.numeric(nba$SimpleORebRate))) # use this one
nba <- read.delim("/Users/mcdickenson/Downloads/playerstats20102011reg20110416.txt", header=T, sep = "\t")
plot(density(as.numeric(nba$SimpleORebRate))) # use this one
plot(density(as.numeric(nba$SimpleDRebRate)))
plot(density(as.numeric(nba$SimpleMin)))
plot(density(as.numeric(nba$SimpleORebFor)))
plot(density(as.numeric(nba$SimpleORebOpp)))
plot(density(as.numeric(nba$SimpleORebRate))) # use this one
plot(density(as.numeric(nba$SimpleORebRate))) # use this one
plot(density(as.numeric(nba$SimpleDRebRate)))
plot(density(as.numeric(nba$SimpleMin)))
plot(density(as.numeric(nba$SimpleORebFor)))
plot(density(as.numeric(nba$SimpleORebOpp)))
head(nba)
plot(density(as.numeric(nba$AdjustedPM)))
plot(density(as.numeric(nba$SimpleORebRate))) # use this one
TradeData <- read.csv("/Users/mcdickenson/Desktop/Education Project/Data/Opinions_Data112911_mod.csv", header=T)
TradeData <- TradeData[TradeData$Finished==1,]
TradeData <- subset(TradeData, select=-c(Q38,Q40))
TradeData <- subset(TradeData, select=-c(ResponseSet,Name,ExternalDataReference,EmailAddress,IPAddress,Status))
TradeData$age <- 2011-TradeData$Q42
TradeData$econ_courses <- 0
ecourses <- 7:11
colnames(TradeData)[7]
colnames(TradeData)[ecourses]
for (i in row.names(TradeData)) {
for(j in colnames(TradeData)[ecourses]) {
if(TradeData[i, j]==1) {
TradeData[i,"econ_courses"] <- TradeData[i,"econ_courses"] + 1
}
}
}
max(TradeData$econ_courses)
hist(TradeData$econ_courses)
TradeData[TradeData$econ_courses==3,]
TradeData$hs_econ <- 0
for (i in row.names(TradeData)) {
for(j in colnames(TradeData)[12:16]) {
if(TradeData[i, j]==1) {
TradeData[i,"hs_econ"] <- TradeData[i,"hs_econ"] + 1
}
}
}
sum(TradeData$hs_econ)
TradeData$ps_courses <- 0
for (i in row.names(TradeData)) {
for(j in colnames(TradeData)[17:21]) {
if(TradeData[i, j]==1) {
TradeData[i,"ps_courses"] <- TradeData[i,"ps_courses"] + 1
}
}
}
TradeData$hs_ps <- 0
for (i in row.names(TradeData)) {
for(j in colnames(TradeData)[22:25]) {
if(TradeData[i, j]==1) {
TradeData[i,"hs_ps"] <- TradeData[i,"hs_ps"] + 1
}
}
}
TradeData$trade <- 0
for (i in row.names(TradeData)) {
if(TradeData[i, "Q8"]==1 | TradeData[i, "Q8"]==2) {
TradeData[i,"trade"] <- TradeData[i,"trade"] + 1
}
if(TradeData[i, "Q8"]==4 | TradeData[i, "Q8"]==5) {
TradeData[i,"trade"] <- TradeData[i,"trade"] - 1
}
}
TradeData$Q8
hist(TradeData$Q8[TradeData$Q8>-1])
hist(TradeData$trade)
TradeData$rem_barriers <- 0
for (i in row.names(TradeData)) {
if(TradeData[i, "Q10"]==1 | TradeData[i, "Q10"]==2) {
TradeData[i,"rem_barriers"] <- TradeData[i,"rem_barriers"] + 1
}
if(TradeData[i, "Q10"]==4 | TradeData[i, "Q10"]==5) {
TradeData[i,"rem_barriers"] <- TradeData[i,"rem_barriers"] - 1
}
}
TradeData$immigration <- 0
for (i in row.names(TradeData)) {
if(TradeData[i, "Q11"]==1 | TradeData[i, "Q11"]==2) {
TradeData[i,"immigration"] <- TradeData[i,"immigration"] - 1
}
if(TradeData[i, "Q11"]==4 | TradeData[i, "Q11"]==5) {
TradeData[i,"immigration"] <- TradeData[i,"immigration"] + 1
}
}
TradeData$imports <- 0
for (i in row.names(TradeData)) {
if(TradeData[i, "Q12"]==1 | TradeData[i, "Q12"]==2) {
TradeData[i,"imports"] <- TradeData[i,"imports"] - 1
}
if(TradeData[i, "Q12"]==4 | TradeData[i, "Q12"]==5) {
TradeData[i,"imports"] <- TradeData[i,"imports"] + 1
}
}
hist(TradeData$imports)
TradeData$buyamerican <- 0
for (i in row.names(TradeData)) {
if(TradeData[i, "Q13"]==1 | TradeData[i, "Q13"]==2) {
TradeData[i,"buyamerican"] <- TradeData[i,"buyamerican"] - 1
}
if(TradeData[i, "Q13"]==4 | TradeData[i, "Q13"]==5) {
TradeData[i,"buyamerican"] <- TradeData[i,"buyamerican"] + 1
}
}
TradeData$buy.affect <- 0
for (i in row.names(TradeData)) {
if(TradeData[i, "Q14"]==1 | TradeData[i, "Q14"]==2) {
TradeData[i,"buy.affect"] <- TradeData[i,"buy.affect"] + 1
}
if(TradeData[i, "Q14"]==4 | TradeData[i, "Q14"]==5) {
TradeData[i,"buy.affect"] <- TradeData[i,"buy.affect"] - 1
}
}
hist(TradeData$buy.affect)
mean(TradeData$age, na.rm=T) # = 18.6
median(TradeData$age, na.rm=T) # 19
max(TradeData$age, na.rm=T) # 21
min(TradeData$age, na.rm=T) # 17
library(ggplot2)
theme_set(theme_bw())
plot_age <- qplot(TradeData$age, geom="density", xlab="Respondent's Age", ylab="Density")
max(TradeData$age, na.rm=T) # 21
max(TradeData$age, na.rm=T) # 21
plot_age
?truehist
library(MASS)
truehist(TradeData$age)
plot_courses <- ggplot(TradeData) + geom_density(aes(x=econ_courses, legend=NULL))
plot_courses <- plot_courses + geom_density(aes(x=hs_econ))
plot_courses <- plot_courses + geom_density(aes(x=ps_courses))
plot_courses <- plot_courses + geom_density(aes(x=hs_ps)) + opts(legend.position = "none")
plot_courses
plot_courses <- plot_courses + scale_colour_gradientn(colours=c(1,2,3,4))
plot_courses
plot_courses <- plot_courses +  opts(legend.position = "none")
econindex2_vars <- c("Q17", "Q18","Q21")
econindex2_names <- c("tariffs","regulation","minwage")
TradeData$tariffs <- 0
TradeData$regulation <- 0
TradeData$minwage <- 0
for (j in 1:3) {
for (i in row.names(TradeData)) {
if(TradeData[i, econindex2_vars[j] ]==1) {
TradeData[i, econindex2_names[j] ] <- TradeData[i, econindex2_names[j] ] - 1
}
if(TradeData[i, econindex2_vars[j] ]==2) {
TradeData[i, econindex2_names[j] ] <- TradeData[i, econindex2_names[j] ] + 1
}
}
}
hist(TradeData$tariffs)
hist(TradeData$regulation)
hist(TradeData$minwage)
TradeData$immigration.change <- 0
for (i in row.names(TradeData)) {
if(TradeData[i, "Q20"]==1) {
TradeData[i,"immigration.change"] <- TradeData[i,"immigration.change"] - 1
}
if(TradeData[i, "Q20"]==2) {
TradeData[i,"immigration.change"] <- TradeData[i,"immigration.change"] + 1
}
}
hist(TradeData$immigration.change)
TradeData$econ_index2 <- TradeData$tariffs + TradeData$regulation + TradeData$minwage + TradeData$immigration.change
hist(TradeData$econ_index2)
TradeData$econ_index3 <- TradeData$econ_index1 + TradeData$econ_index2
hist(TradeData$econ_index3)
TradeData$econ_index3 <- TradeData$econ_index1 + TradeData$econ_index2
TradeData$econ_index2 <- TradeData$tariffs + TradeData$regulation + TradeData$minwage + TradeData$immigration.change
hist(TradeData$econ_index2)
TradeData$econ_index3 <- TradeData$econ_index1 + TradeData$econ_index2
hist(TradeData$econ_index1)
head(TradeData)
TradeData$econ_index1 <- 0
for(i in row.names(TradeData)) {
TradeData[i,"econ_index1"] <- sum(TradeData[i,76:80])
}
TradeData$econ_index3 <- TradeData$econ_index1 + TradeData$econ_index2
hist(TradeData$econ_index3)
TradeData$democrat <- as.numeric(TradeData$Q51==1)
TradeData$republican <- as.numeric(TradeData$Q51==2)
hist(TradeData$democrat)
hist(TradeData$republican)
prop.table(table(TradeData$Q51,TradeData$democrat))
prop.table(table(TradeData$Q51,TradeData$republican))
attentive.vars <- c("Q27", "Q30", "Q33")
attentive.names <- c("tv","newsprint","newsonline")
TradeData$tv <- 0
TradeData$newsprint <- 0
TradeData$newsonline <- 0
for (j in 1:3) {
for (i in row.names(TradeData)) {
if(TradeData[i, attentive.vars[j] ]==1) {
TradeData[i, attentive.names[j] ] <- TradeData[i, attentive.names[j] ] + 1
}
if(TradeData[i, attentive.vars[j] ]==2) {
TradeData[i, attentive.names[j] ] <- TradeData[i, attentive.names[j] ] + 3
}
if(TradeData[i, attentive.vars[j] ]==3) {
TradeData[i, attentive.names[j] ] <- TradeData[i, attentive.names[j] ] + 5
}
if(TradeData[i, attentive.vars[j] ]==4) {
TradeData[i, attentive.names[j] ] <- TradeData[i, attentive.names[j] ] + 7
}
}
}
hist(TradeData$tv)
hist(TradeData$newsprint)
hist(TradeData$newsonline)
TradeData$attentiveness <- TradeData$tv + TradeData$newsprint + TradeData$newsonline
hist(TradeData$attentiveness)
TradeData$logattent <- log(TradeData$attentiveness)
hist(TradeData$attentiveness)
hist(TradeData$logattent)
plot1 <- qplot(TradeData$econ_courses, TradeData$econ_index3)
plot1 <- plot1 + geom_jitter()
plot1
plot1 <- plot1 + geom_line(as.real(TradeData$econ_courses), round(TradeData$econ_index3))
plot2 <- qplot(TradeData$ps_courses, TradeData$econ_index3)
plot2 <- plot2 + geom_jitter()
plot2
plot3 <- qplot(TradeData$econ_courses, TradeData$econ_index3, colour="blue")
plot3 <- plot3 + geom_jitter()
plot1
plot3
head(TradeData)
TradeData$econ_ps_diff <- TradeData$econ_courses - TradeData$ps_courses
TradeData$more_econ <- 0
for (i in row.names(TradeData)) {
if(TradeData[i, "econ_ps_diff"]>=1) {
TradeData[i,"more_econ"] <- TradeData[i,"more_econ"] + 1
}
if(TradeData[i, "econ_ps_diff"]<=-1) {
TradeData[i,"more_econ"] <- TradeData[i,"more_econ"] - 1
}
}
plot(TradeData$more_econ, TradeData$econ_index3)
plot(TradeData$econ_index3)
plot(TradeData$more_econ, TradeData$econ_index3, col=TradeData$more_econ)
plot(TradeData$more_econ, TradeData$econ_index3, col=TradeData$more_econ+3)
plot(TradeData$attentiveness, TradeData$econ_index3)
plot(TradeData$attentiveness, TradeData$econ_index3, col=TradeData$more_econ+3)
plot(TradeData$attentiveness, TradeData$econ_index3, col=TradeData$more_econ+3, pch=16)
plot(TradeData$more_econ, TradeData$econ_index3, col=TradeData$more_econ+3)
plot(TradeData$attentiveness, TradeData$econ_index3, col=TradeData$more_econ+3, pch=16)
blueline <- lm(TradeData$econ_index3, TradeData$attentiveness, data = TradeData[TradeData$more_econ==1,])
TradeData[TradeData$more_econ==1,]
blueline <- lm(econ_index3, attentiveness, data = TradeData[TradeData$more_econ==1,])
blueline <- lm(TradeData$econ_index3, TradeData$attentiveness, data = TradeData[TradeData$more_econ==1,])
blueline <- lm(TradeData[,"econ_index3"], TradeData[,"attentiveness"], data = TradeData[TradeData$more_econ==1,])
?lm
blueline <- lm(TradeData[,"econ_index3"] ~ TradeData[,"attentiveness"], data = TradeData[TradeData$more_econ==1,])
abline(blueline)
abline(blueline, col=4)
plot(TradeData$more_econ, TradeData$econ_index3, col=TradeData$more_econ+3)
redline <- <- lm(TradeData[,"econ_index3"] ~ TradeData[,"attentiveness"], data = TradeData[TradeData$more_econ==-1,])
redline <- lm(TradeData[,"econ_index3"] ~ TradeData[,"attentiveness"], data = TradeData[TradeData$more_econ==-1,])
greenline <- lm(TradeData[,"econ_index3"] ~ TradeData[,"attentiveness"], data = TradeData[TradeData$more_econ==0,])
plot(TradeData$attentiveness, TradeData$econ_index3, col=TradeData$more_econ+3, pch=16)
abline(blueline, col = 4)
abline(redline, col = 2)
abline(greenline, col = 3)
blueline <- lm(TradeData[,"econ_index3"] ~ TradeData[,"attentiveness"], data = TradeData[TradeData$more_econ==1,])
redline <- lm(TradeData[,"econ_index3"] ~ TradeData[,"attentiveness"], data = TradeData[TradeData$more_econ==-1,])
greenline <- lm(TradeData[,"econ_index3"] ~ TradeData[,"attentiveness"], data = TradeData[TradeData$more_econ==0,])
plot(TradeData$attentiveness, TradeData$econ_index3, col=TradeData$more_econ+3, pch=16)
abline(blueline, col = 4)
abline(redline, col = 2)
TradeData[TradeData$more_econ==1,]
TradeData[TradeData$more_econ==-1,]
?subset
blue <- subset(TradeData, TradeData$more_econ==1)
blueline <- lm(blue[,"econ_index3"] ~ blue[,"attentiveness"], data = blue)
plot(TradeData$attentiveness, TradeData$econ_index3, col=TradeData$more_econ+3, pch=16)
abline(blueline, col = 4)
red <- subset(TradeData, TradeData$more_econ==-1)
green <- subset(TradeData, TradeData$more_econ==0)
blueline <- lm(blue[,"econ_index3"] ~ blue[,"attentiveness"], data = blue)
redline <- lm(red[,"econ_index3"] ~ red[,"attentiveness"], data = red)
greenline <- lm(green[,"econ_index3"] ~ green[,"attentiveness"], data = green)
plot(TradeData$attentiveness, TradeData$econ_index3, col=TradeData$more_econ+3, pch=16)
abline(blueline, col = 4)
abline(redline, col = 2)
abline(greenline, col = 3)
plot(TradeData$attentiveness, TradeData$econ_index3, col=TradeData$more_econ+3, pch=16, xlab="Attentiveness", ylab="Economic Index Score")
abline(blueline, col = 4)
abline(redline, col = 2)
abline(greenline, col = 3)
truehist(TradeData$econ_index3)
truehist(TradeData$econ_index3, xlab="Index")
truehist(TradeData$econ_index3, xlab="Economic Index Scores")
?truehist
truehist(TradeData$econ_index3, xlab="Economic Index Scores",col=4)
truehist(TradeData$econ_index3, xlab="Economic Index Scores",col=rgb(0,255,255))
truehist(TradeData$econ_index3, xlab="Economic Index Scores",col=rgb(0,255,255, 0.1))
?rgb
truehist(TradeData$econ_index3, xlab="Economic Index Scores",col=rgb(0,0,255, 255))
truehist(TradeData$econ_index3, xlab="Economic Index Scores",col=rgb(0,0,255, .5))
truehist(TradeData$econ_index3, xlab="Economic Index Scores",col=rgb(255,0,0,75,maxColorValue=255))
truehist(TradeData$econ_index3, xlab="Economic Index Scores",col=rgb(0,0,255,75,maxColorValue=255))
truehist(TradeData$econ_index3, xlab="Economic Index Scores",col=rgb(0,0,255,125,maxColorValue=255))
truehist(TradeData$econ_index3, xlab="Economic Index Scores",col=rgb(0,0,255,200,maxColorValue=255))
plot(TradeData$attentiveness, TradeData$econ_index3, col=TradeData$more_econ+3, pch=16, xlab="Attentiveness", ylab="Economic Index Score")
truehist(TradeData$econ_index3, xlab="Economic Index Scores",col=rgb(0,0,255,200,maxColorValue=255))
truehist(blue$econ_index3)
truehist(blue$econ_index3, col=rgb(0,0,255,200,maxColorValue=255))
truehist(blue$econ_index3, col=rgb(0,0,255,200,maxColorValue=255), xlab="More Econ than PS Courses")
truehist(red$econ_index3, col=rgb(255,0,0,200,maxColorValue=255), xlab="More PS than Econ Courses")
truehist(TradeData$econ_index3, xlab="Economic Index Scores")
truehist(TradeData$econ_index3, xlab="Overall Economic Index Scores")
truehist(blue$econ_index3, col=rgb(0,0,255,200,maxColorValue=255), xlab="More Econ than PS Courses")
truehist(red$econ_index3, col=rgb(255,0,0,200,maxColorValue=255), xlab="More PS than Econ Courses")
truehist(green$econ_index3, col=rgb(0,255,0,200,maxColorValue=255), xlab="Equal # of Econ and PS Courses")
?truehist
truehist(TradeData$econ_index3, xlab="Overall Economic Index Scores")
truehist(blue$econ_index3, col=rgb(0,0,255,200,maxColorValue=255), xlab="More Econ than PS Courses")
truehist(blue$econ_index3, nbins=8 col=rgb(0,0,255,200,maxColorValue=255), xlab="More Econ than PS Courses")
truehist(TradeData$econ_index3, xlab="Overall Economic Index Scores")
truehist(blue$econ_index3, nbins=8, col=rgb(0,0,255,200,maxColorValue=255), xlab="More Econ than PS Courses")
truehist(TradeData$econ_index3, xlab="Overall Economic Index Scores")
truehist(red$econ_index3,nbins=8 col=rgb(255,0,0,200,maxColorValue=255), xlab="More PS than Econ Courses")
truehist(red$econ_index3,nbins=8m col=rgb(255,0,0,200,maxColorValue=255), xlab="More PS than Econ Courses")
truehist(TradeData$econ_index3, xlab="Overall Economic Index Scores")
?truehist
truehist(TradeData$econ_index3, xlim=c(-10,10), xlab="Overall Economic Index Scores")
truehist(blue$econ_index3, nbins=8, xlim=c(-10,10), col=rgb(0,0,255,200,maxColorValue=255), xlab="More Econ than PS Courses")
truehist(red$econ_index3,nbins=8,, xlim=c(-10,10), col=rgb(255,0,0,200,maxColorValue=255), xlab="More PS than Econ Courses")
truehist(red$econ_index3, xlim=c(-10,10), col=rgb(255,0,0,200,maxColorValue=255), xlab="More PS than Econ Courses")
truehist(red$econ_index3,nbins=8 xlim=c(-10,10), col=rgb(255,0,0,200,maxColorValue=255), xlab="More PS than Econ Courses")
truehist(red$econ_index3,nbins=8, xlim=c(-10,10), col=rgb(255,0,0,200,maxColorValue=255), xlab="More PS than Econ Courses")
truehist(green$econ_index3,nbins=8, xlim=c(-10,10), col=rgb(0,255,0,200,maxColorValue=255), xlab="Equal # of Econ and PS Courses")
truehist(TradeData$econ_index3, xlim=c(-10,10), xlab="Overall Economic Index Scores")
truehist(blue$econ_index3, nbins=8, xlim=c(-10,10), col=rgb(0,0,255,200,maxColorValue=255), xlab="More Econ than PS Courses")
truehist(red$econ_index3,nbins=8, xlim=c(-10,10), col=rgb(255,0,0,200,maxColorValue=255), xlab="More PS than Econ Courses")
truehist(green$econ_index3,nbins=8, xlim=c(-10,10), col=rgb(0,255,0,200,maxColorValue=255), xlab="Equal # of Econ and PS Courses")
plot(density(TradeData$econ_index3))
lines(density(blue$econ_index3), col='blue')
plot(density(TradeData$econ_index3))
lines(density(blue$econ_index3), col='blue')
lines(density(red$econ_index3), col='red')
lines(density(green$econ_index3), col='green')
plot(density(TradeData$econ_index3))
lines(density(blue$econ_index3), col='blue')
lines(density(red$econ_index3), col='red')
plot(density(TradeData$econ_index3),lwd=3)
lines(density(blue$econ_index3), col='blue',lwd=3)
lines(density(red$econ_index3), col='red',lwd=3)
plot(density(blue$econ_index3), col='blue',lwd=3)
lines(density(red$econ_index3), col='red',lwd=3)
polygon(density(blue$econ_index3), col=rgb(0,0,255,200,maxColorValue=255), border=NULL)
lines(density(red$econ_index3), col='red',lwd=3)
lines(density(red$econ_index3), col='red',lwd=3)
polygon(density(red$econ_index3), col=rgb(255,0,0,100,maxColorValue=255), border=NULL)
plot(density(blue$econ_index3), col='blue',lwd=3)
polygon(density(blue$econ_index3), col=rgb(0,0,255,100,maxColorValue=255), border=NULL)
lines(density(red$econ_index3), col='red',lwd=3)
polygon(density(red$econ_index3), col=rgb(255,0,0,100,maxColorValue=255), border=NULL)
plot(density(blue$econ_index3), col='blue',lwd=3, main="Economic Index Scores by Discipline")
polygon(density(blue$econ_index3), col=rgb(0,0,255,100,maxColorValue=255), border=NULL)
lines(density(red$econ_index3), col='red',lwd=3)
polygon(density(red$econ_index3), col=rgb(255,0,0,100,maxColorValue=255), border=NULL)
plot(density(blue$econ_index3), col='blue',lwd=3, main="Economic Index Scores by Discipline",xlab='n')
nrow(blue)
nrow(red)
plot(density(blue$econ_index3), col='blue',lwd=3, main="Economic Index Scores by Discipline",xlab='N=62')
polygon(density(blue$econ_index3), col=rgb(0,0,255,100,maxColorValue=255), border=NULL)
lines(density(red$econ_index3), col='red',lwd=3)
polygon(density(red$econ_index3), col=rgb(255,0,0,100,maxColorValue=255), border=NULL)
plot(density(blue$econ_index3), col='blue',lwd=3, main="Economic Index Scores by Discipline",xlab='N=62',xlim=c(-10,10))
polygon(density(blue$econ_index3), col=rgb(0,0,255,100,maxColorValue=255), border=NULL)
lines(density(red$econ_index3), col='red',lwd=3)
polygon(density(red$econ_index3), col=rgb(255,0,0,100,maxColorValue=255), border=NULL)
plot(density(blue$econ_index3), col='blue',lwd=3, main="Economic Index Scores by Discipline",xlab='N=62',xlim=c(-10,10))
polygon(density(blue$econ_index3), col=rgb(0,0,255,100,maxColorValue=255), border=NULL)
lines(density(red$econ_index3), col='red',lwd=3)
polygon(density(red$econ_index3), col=rgb(255,0,0,100,maxColorValue=255), border=NULL)
lines(density(red$econ_index3), col='red',lwd=3)
plot(density(blue$econ_index3), col='blue',lwd=3, main="Economic Index Scores by Discipline",xlab='N=62',xlim=c(-10,10))
polygon(density(blue$econ_index3), col=rgb(0,0,255,100,maxColorValue=255), border=NULL)
polygon(density(red$econ_index3), col=rgb(255,0,0,100,maxColorValue=255), border=NULL)
lines(density(red$econ_index3), col='red',lwd=3)
SmoothCoefficientPlot <- function(models, modelnames = "", removeintercept = FALSE){
# models must be a list()
Alphas <- seq(1, 99, 2) / 100
Multiplier <- qnorm(1 - Alphas / 2)
zzTransparency <<- 1/(length(Multiplier)/4)
CoefficientTables <- lapply(models, function(x){summary(x)$coef})
TableRows <- unlist(lapply(CoefficientTables, nrow))
if(modelnames[1] == ""){
ModelNameLabels <- rep(paste("Model", 1:length(TableRows)), TableRows)
} else {
ModelNameLabels <- rep(modelnames, TableRows)
}
MatrixofModels <- cbind(do.call(rbind, CoefficientTables), ModelNameLabels)
if(removeintercept == TRUE){
MatrixofModels <- MatrixofModels[!rownames(MatrixofModels) == "(Intercept)", ]
}
MatrixofModels <- data.frame(cbind(rownames(MatrixofModels), MatrixofModels))
MatrixofModels <- data.frame(cbind(MatrixofModels, rep(Multiplier, each = nrow(MatrixofModels))))
colnames(MatrixofModels) <- c("IV", "Estimate", "StandardError", "TValue", "PValue", "ModelName", "Scalar")
MatrixofModels$IV <- factor(MatrixofModels$IV, levels = MatrixofModels$IV)
MatrixofModels[, -c(1, 6)] <- apply(MatrixofModels[, -c(1, 6)], 2, function(x){as.numeric(as.character(x))})
MatrixofModels$Emphasis <- by(1 - seq(0, 1, length = length(Multiplier) + 1)[-1], as.character(round(Multiplier, 5)), mean)[as.character(round(MatrixofModels$Scalar, 5))]
OutputPlot <- qplot(data = MatrixofModels, x = IV, y = Estimate,
ymin = Estimate - Scalar * StandardError, ymax = Estimate + Scalar * StandardError,
ylab = NULL, xlab = NULL, alpha = I(zzTransparency), colour = I(gray(0)), geom = "blank")
OutputPlot <- OutputPlot + geom_hline(yintercept = 0, lwd = I(7/12), colour = I(hsv(0/12, 7/12, 7/12)), alpha = I(5/12))
OutputPlot <- OutputPlot + geom_linerange(data = MatrixofModels, aes(size = 1/Emphasis), alpha = I(zzTransparency), colour = I(gray(0)))
OutputPlot <- OutputPlot + scale_size_continuous(legend = FALSE)
OutputPlot <- OutputPlot + facet_grid(~ ModelName) + coord_flip() + geom_point(aes(x = IV, y = Estimate), colour = I(gray(0))) + theme_bw()
return(OutputPlot)
}
apsrtable(model12, model15, model14, model17, model13, model16)
library(apsrtable)
apsrtable(model12, model15, model14, model17, model13, model16)
library(apsrtable)
install.packages('apsrtable')
library(apsrtable)
apsrtable(model12, model15, model14, model17, model13, model16)
model12 <- lm(TradeData$econ_index3 ~ TradeData$econ_courses + TradeData$hs_econ)
model13 <- lm(TradeData$econ_index3 ~ TradeData$econ_courses + TradeData$hs_econ + TradeData$ps_courses + TradeData$hs_ps)
model14 <- lm(TradeData$econ_index3 ~ TradeData$ps_courses + TradeData$hs_ps)
model15 <- lm(TradeData$econ_index3 ~ TradeData$econ_courses + TradeData$hs_econ + TradeData$democrat + TradeData$republican)
model16 <- lm(TradeData$econ_index3 ~ TradeData$econ_courses + TradeData$hs_econ + TradeData$ps_courses + TradeData$hs_ps + TradeData$democrat + TradeData$republican)
model17 <- lm(TradeData$econ_index3 ~ TradeData$ps_courses + TradeData$hs_ps + TradeData$democrat + TradeData$republican)
apsrtable(model12, model15, model14, model17, model13, model16)
(model12, model15, model14, model17, model13, model16)
(model12, model15, model14, model17, model13, model16)
model_list <- c(model12, model15, model14, model17, model13, model16)
(model12, model15, model14, model17, model13, model16)
SmoothCoefficientPlot(model_list)
summary(model12)$coef
setwd('/Users/mcdickenson/github/PS398/HW5/')
gelman <- read.csv('GelmanBlogScrapeFull.csv', header=T)
head(gelman)
plot(gelman$length, gelman$comments)
plot(gelman$length[gelman$length != NA], gelman$comments[gelman$length != NA])
plot(gelman$length[gelman$length != NA], gelman$comments[gelman$length != NA],xlim=c(0,30))
plot(gelman$length[gelman$length != NA], gelman$comments[gelman$length != NA],xlim=c(0,4000),ylim=c(0,40))
plot(gelman$Length[gelman$Length != NA], gelman$Comments[gelman$Length != NA],xlim=c(0,4000),ylim=c(0,40))
head(gelman)
plot(gelman$Length, gelman$Comments,xlim=c(0,4000),ylim=c(0,40))
plot(gelman$Length, gelman$Comments,xlim=c(0,4000),ylim=c(0,30))
